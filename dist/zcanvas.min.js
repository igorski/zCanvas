(()=>{"use strict";function t(){this._eventMappings=[],this._disposed=!1}const e=t;t.prototype.add=function(t,e,i){return!this.has(t,e)&&(t.addEventListener(e,i,!1),this._eventMappings.push({element:t,type:e,listener:i}),!0)},t.prototype.has=function(t,e){for(var i=this._eventMappings.length;i--;){var n=this._eventMappings[i];if(n.element===t&&n.type==e)return!0}return!1},t.prototype.remove=function(t,e){for(var i=this._eventMappings.length;i--;){var n=this._eventMappings[i];if(n.element===t&&n.type===e)return t.removeEventListener(e,n.listener,!1),this._eventMappings.splice(i,1),!0}return!1},t.prototype.dispose=function(){if(!this._disposed){this._disposed=!0;for(var t=this._eventMappings.length;t--;){var e=this._eventMappings[t];this.remove(e.element,e.type)}this._eventMappings=null}};var i={extend:function(t,e){function n(){}n.prototype=e.prototype,t.superClass_=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.super=function(t,i,n){for(var o=new Array(arguments.length-2),s=2;s<arguments.length;s++)o[s-2]=arguments[s];return e.prototype[i].apply(t,o)},t.extend=function(e){i.extend(e,t)}}};const n=i;var o=Math.min,s=Math.max,r=Math.round,h=60,a=h+3;function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,i=void 0===e?300:e,n=t.height,o=void 0===n?300:n,s=t.fps,r=void 0===s?h:s,a=t.scale,d=void 0===a?1:a,l=t.backgroundColor,p=void 0===l?null:l,u=t.animate,c=void 0!==u&&u,_=t.smoothing,f=void 0===_||_,g=t.stretchToFit,v=void 0!==g&&g,m=t.viewport,w=void 0===m?null:m,y=t.handler,b=void 0===y?null:y,C=t.preventEventBubbling,x=void 0!==C&&C,I=t.parentElement,E=void 0===I?null:I,H=t.debug,R=void 0!==H&&H,S=t.onUpdate,k=void 0===S?null:S;if(i<=0||o<=0)throw new Error("cannot construct a zCanvas without valid dimensions");this.DEBUG=R,this._smoothing=f,this._updateHandler=k,this._renderHandler=this.render.bind(this),this._lastRender=0,this._renderId=0,this._renderPending=!1,this._disposed=!1,this._scale={x:d,y:d},this._handler=b,this._activeTouches=[],this._children=[],this._coords=null,this._width=0,this._height=0,this.setFrameRate(r),this.setAnimatable(c),this._element=document.createElement("canvas"),this._canvasContext=this._element.getContext("2d"),p&&this.setBackgroundColor(p);var B=this._canvasContext,P=window.devicePixelRatio||1,M=B.webkitBackingStorePixelRatio||B.mozBackingStorePixelRatio||B.msBackingStorePixelRatio||B.oBackingStorePixelRatio||B.backingStorePixelRatio||1,W=P/M;this._HDPIscaleRatio=P!==M?W:1,this.setDimensions(i,o,!0,!0),w&&this.setViewport(w.width,w.height),1!==d&&this.scale(d,d),v&&this.stretchToFit(!0),E instanceof Element&&this.insertInPage(E),this.setSmoothing(f),this.preventEventBubbling(x),this.addListeners(),this._animate&&this.render()}function l(t){var e,i,n=t._HDPIscaleRatio,s=t._viewport;if(t._enqueuedSize){var r=t._enqueuedSize;e=r.width,i=r.height,t._enqueuedSize=null,t._width=e,t._height=i}if(s){var h=t._width,a=t._height;e=o(s.width,h),i=o(s.height,a)}if(e&&i){var d=t._element;d.width=e*n,d.height=i*n,d.style.width="".concat(e,"px"),d.style.height="".concat(i,"px")}t._canvasContext.scale(n,n),!1===t._smoothing&&t.setSmoothing(!1),t._coords=null}d.extend=function(t){n.extend(t,d)},d.prototype.insertInPage=function(t){if(this._element.parentNode)throw new Error("Canvas already present in DOM");t.appendChild(this._element)},d.prototype.getElement=function(){return this._element},d.prototype.getCanvasContext=function(){return this._canvasContext},d.prototype.preventEventBubbling=function(t){this._preventDefaults=t},d.prototype.addChild=function(t){if(this.contains(t))return this;var e=this._children.length;return e>0&&(t.last=this._children[e-1],t.last.next=t),t.next=null,t.setCanvas(this),t.setParent(this),this._children.push(t),this.invalidate(),this},d.prototype.removeChild=function(t){t.setParent(null),t.setCanvas(null);var e=this._children.indexOf(t);-1!==e&&this._children.splice(e,1);var i=t.last,n=t.next;return i&&(i.next=n),n&&(n.last=i),t.last=t.next=null,this.invalidate(),t},d.prototype.getChildAt=function(t){return this._children[t]},d.prototype.removeChildAt=function(t){return this.removeChild(this.getChildAt(t))},d.prototype.numChildren=function(){return this._children.length},d.prototype.getChildren=function(){return this._children},d.prototype.contains=function(t){return t._parent===this},d.prototype.invalidate=function(){this._animate||this._renderPending||(this._renderPending=!0,this._renderId=window.requestAnimationFrame(this._renderHandler))},d.prototype.getFrameRate=function(){return this._fps},d.prototype.setFrameRate=function(t){this._fps=t,this._aFps=t,this._renderInterval=1e3/t},d.prototype.getActualFrameRate=function(){return this._aFps},d.prototype.getRenderInterval=function(){return this._renderInterval},d.prototype.getSmoothing=function(){return this._smoothing},d.prototype.setSmoothing=function(t){this._smoothing=t;var e=this._element.style,i=this._canvasContext;["imageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","webkitImageSmoothingEnabled"].forEach((function(e){void 0!==i[e]&&(i[e]=t)})),["-moz-crisp-edges","-webkit-crisp-edges","pixelated","crisp-edges"].forEach((function(i){e["image-rendering"]=t?void 0:i})),this.invalidate()},d.prototype.getWidth=function(){return this._enqueuedSize?this._enqueuedSize.width:this._width},d.prototype.getHeight=function(){return this._enqueuedSize?this._enqueuedSize.height:this._height},d.prototype.setDimensions=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._enqueuedSize={width:t,height:e},!0===i&&(this._preferredWidth=t,this._preferredHeight=e),!0===n&&l(this),this.invalidate()},d.prototype.getViewport=function(){return this._viewport},d.prototype.setViewport=function(t,e){this._viewport={width:t,height:e},this.panViewport(0,0),l(this)},d.prototype.panViewport=function(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this._viewport;r.left=s(0,o(t,this._width-r.width)),r.right=r.left+r.width,r.top=s(0,o(e,this._height-r.height)),r.bottom=r.top+r.height,this.invalidate(),n&&(null===(i=this._handler)||void 0===i||i.call(this,{type:"panned",value:r}))},d.prototype.setBackgroundColor=function(t){this._bgColor=t},d.prototype.setAnimatable=function(t){var e;this._animate,this._animate=t,this._lastRaf=(null===(e=window.performance)||void 0===e?void 0:e.now())||Date.now(),t&&!this._renderPending&&this._renderHandler(this._lastRaf)},d.prototype.isAnimatable=function(){return this._animate},d.prototype.drawImage=function(t,e,i,n,s,r,h,a,d){if(e=.5+e<<0,i=.5+i<<0,s=.5+s<<0,!((n=.5+n<<0)<=0||s<=0)){var l=this._canvasContext;if("number"==typeof r){var p=(n=o(l.canvas.width,n))/a,u=(s=o(l.canvas.height,s))/d;r+a>t.width&&(n-=p*(r+a-t.width),a-=r+a-t.width),h+d>t.height&&(s-=u*(h+d-t.height),d-=h+d-t.height),l.drawImage(t,r,h,a,d,e,i,n,s)}else l.drawImage(t,e,i,n,s)}},d.prototype.scale=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this._scale={x:t,y:e};var i=1===t&&1===e?"":"scale(".concat(t,", ").concat(e,")"),n=this._element.style;n["-webkit-transform-origin"]=n["transform-origin"]="0 0",n["-webkit-transform"]=n.transform=i,this.invalidate()},d.prototype.stretchToFit=function(t){this._stretchToFit=t;var e=window,i=e.innerWidth,n=e.innerHeight,o=this._preferredWidth,s=this._preferredHeight,h=1,a=1;n>i?(h=i/o,a=n/(s=t?n/i*o:s)):(h=i/(o=t?i/n*s:o),a=n/s),this.setDimensions(r(o),r(s),!1,!0),this.scale(h,a)},d.prototype.dispose=function(){if(!this._disposed){this._animate=!1,window.cancelAnimationFrame(this._renderId),this.removeListeners();for(var t=this.numChildren();t--;)this._children[t].dispose();this._children=[],this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._disposed=!0}},d.prototype.handleInteraction=function(t){var e,i,n=this._children.length,o=this._viewport;if(n>0)switch(i=this._children[n-1],t.type){default:var s=0,r=0,h=t.changedTouches,a=0,d=h.length;if(d>0){var l=this.getCoordinate(),p=l.x,u=l.y;for(o&&(p-=o.left,u-=o.top),a=0;a<d;++a){var c=h[a],_=c.identifier;if(s=c.pageX-p,r=c.pageY-u,"touchstart"===t.type){for(;i;){if(!this._activeTouches.includes(i)&&i.handleInteraction(s,r,t)){this._activeTouches[_]=i;break}i=i.last}i=this._children[n-1]}else null!==(e=i=this._activeTouches[_])&&void 0!==e&&e.handleInteraction(s,r,t)&&"touchmove"!==t.type&&(this._activeTouches[_]=null)}}break;case"mousedown":case"mousemove":case"mouseup":var f=t.offsetX,g=t.offsetY;for(o&&(f+=o.left,g+=o.top);i&&!i.handleInteraction(f,g,t);)i=i.last;break;case"wheel":var v=t.deltaX,m=t.deltaY,w=0===v?0:v>0?20:-20,y=0===m?0:m>0?20:-20;this.panViewport(o.left+w,o.top+y,!0)}this._preventDefaults&&(t.stopPropagation(),t.preventDefault()),this._animate||this.invalidate()},d.prototype.render=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._renderPending=!1;var e,i=t-this._lastRender;if(this._animate&&i/this._renderInterval<.999)return this._renderId=window.requestAnimationFrame(this._renderHandler),void(this._lastRaf=t);this._aFps=1e3/(t-this._lastRaf),e=this._fps>h?this._fps/this._aFps:this._fps===h&&this._aFps>a?1:1/(this._fps/this._aFps),this._lastRaf=t,this._lastRender=t-i%this._renderInterval,this._enqueuedSize&&l(this);var n,o=this._canvasContext;if(o){var s=this._width,r=this._height;this._bgColor?(o.fillStyle=this._bgColor,o.fillRect(0,0,s,r)):o.clearRect(0,0,s,r);var d="function"==typeof this._updateHandler;for(d&&this._updateHandler(t,e),n=this._children[0];n;)d||n.update(t,e),n.draw(o,this._viewport),n=n.next}!this._disposed&&this._animate&&(this._renderPending=!0,this._renderId=window.requestAnimationFrame(this._renderHandler))},d.prototype.addListeners=function(){var t=this;this._eventHandler||(this._eventHandler=new e);var i=this._eventHandler,n=this.handleInteraction.bind(this),o=this._element;"ontouchstart"in window&&["start","move","end","cancel"].forEach((function(t){i.add(o,"touch".concat(t),n)})),["down","move"].forEach((function(t){i.add(o,"mouse".concat(t),n)})),i.add(window,"mouseup",n),this._viewport&&i.add(o,"wheel",n),this._stretchToFit&&i.add(window,"resize",(function(){t.stretchToFit(t._stretchToFit)}))},d.prototype.removeListeners=function(){this._eventHandler&&this._eventHandler.dispose(),this._eventHandler=null},d.prototype.getCoordinate=function(){return null===this._coords&&(this._coords=this._element.getBoundingClientRect()),this._coords};var p={loadImage:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(n,o){var s,r,h,a,d,l=i||new window.Image,u="data:"===(r=("string"==typeof(s=t)?s:s.src).substr(0,5))||"blob:"===r,_=new e;u||(d=l,h=t,a=window.location,!(!h.startsWith("./")&&!h.startsWith("".concat(a.protocol,"//").concat(a.host))&&/^http[s]?:/.test(h))||(d.crossOrigin="Anonymous"),_.add(l,"load",(function(){_.dispose(),p.onReady(l).then((function(t){return n(c(l))})).catch(o)})),_.add(l,"error",(function(t){_.dispose(),o(t)}))),l.src=t,u&&p.onReady(l).then((function(t){return n(c(l))})).catch(o)}))},isReady:function(t){return!0===t.complete&&"number"==typeof t.naturalWidth&&t.naturalWidth>0},onReady:function(t){return new Promise((function(e,i){var n=0;!function o(){p.isReady(t)?e():60==++n?i(new Error("Image could not be resolved. This shouldn't occur.")):window.requestAnimationFrame(o)}()}))}};const u=p;function c(t){var e={image:t,size:null};return t instanceof window.HTMLImageElement&&(e.size=function(t){return{width:t.width||t.naturalWidth,height:t.height||t.naturalHeight}}(t)),e}var _=Math.min,f=Math.max,g=.5;function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,i=t.height,n=t.x,o=void 0===n?0:n,s=t.y,r=void 0===s?0:s,h=t.bitmap,a=void 0===h?null:h,d=t.collidable,l=void 0!==d&&d,p=t.interactive,u=void 0!==p&&p,c=t.mask,_=void 0!==c&&c,f=t.sheet,g=void 0===f?[]:f,v=t.sheetTileWidth,m=void 0===v?0:v,w=t.sheetTileHeight,y=void 0===w?0:w;if(e<=0||i<=0)throw new Error("cannot construct a zSprite without valid dimensions");if(this._children=[],this._disposed=!1,this.collidable=l,this.hover=!1,this._mask=_,this._bounds={left:0,top:0,width:e,height:i},this._parent=null,this.last=null,this.next=null,this.canvas=null,this._bitmap,this._bitmapReady=!1,this._draggable=!1,this._keepInBounds=!1,this.isDragging=!1,this.setX(o),this.setY(r),this.setInteractive(u),a&&this.setBitmap(a),Array.isArray(g)&&g.length>0){if(!a)throw new Error("cannot use a spritesheet without a valid Bitmap");this.setSheet(g,m,y)}}v.extend=function(t){n.extend(t,v)},v.prototype.getDraggable=function(){return this._draggable},v.prototype.setDraggable=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._draggable=t,this._keepInBounds=!!this._constraint||e,t&&!this._interactive&&this.setInteractive(!0)},v.prototype.getX=function(){return this._bounds.left},v.prototype.setX=function(t){var e=t-this._bounds.left;this._bounds.left=this._constraint?t+this._constraint.left:t;for(var i=this._children[0];i;)i.isDragging||i.setX(i._bounds.left+e),i=i.next},v.prototype.getY=function(){return this._bounds.top},v.prototype.setY=function(t){var e=t-this._bounds.top;this._bounds.top=this._constraint?t+this._constraint.top:t;for(var i=this._children[0];i;)i.isDragging||i.setY(i._bounds.top+e),i=i.next},v.prototype.getWidth=function(){return this._bounds.width},v.prototype.setWidth=function(t){var e=this._bounds.width||0;this._bounds.width=t,0!==e&&(this._bounds.left-=t*g-e*g),this.invalidate()},v.prototype.getHeight=function(){return this._bounds.height},v.prototype.setHeight=function(t){var e=this._bounds.height||0;this._bounds.height=t,0!==e&&(this._bounds.top-=t*g-e*g),this.invalidate()},v.prototype.setBounds=function(t,e,i,n){if(this._constraint)t-=this._constraint.left,e-=this._constraint.top;else if(!this.canvas)throw new Error("cannot update position of a Sprite that has no constraint or is not added to a canvas");"number"==typeof i&&(this._bounds.width=i),"number"==typeof n&&(this._bounds.height=n);var o=this._bounds.width,s=this._bounds.height,r=this._constraint?this._constraint.width:this.canvas.width,h=this._constraint?this._constraint.height:this.canvas.height;if(this._keepInBounds){var a=_(0,-(o-r)),d=_(0,-(s-h)),l=h-s;t=_(r-o,f(t,a)),e=_(l,f(e,d))}else t>r&&(t+=o*g),e>h&&(e+=s*g);this.setX(t),this.setY(e)},v.prototype.getBounds=function(){return this._bounds},v.prototype.getInteractive=function(){return this._interactive},v.prototype.setInteractive=function(t){this._interactive=t},v.prototype.update=function(t,e){for(var i=this._children[0];i;)i.update(t),i=i.next;this._animation&&this.updateAnimation(e)},v.prototype.draw=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.canvas){var i=this._bounds,n=this._bitmapReady;if(n&&e&&(n=function(t,e){var i=t.left,n=t.top;return i+t.width>=e.left&&i<=e.right&&n+t.height>=e.top&&n<=e.bottom}(i,e)),t.save(),this._mask&&(t.globalCompositeOperation="destination-in"),n){var o=this._animation,s=i.left,r=i.top,h=i.width,a=i.height;if(o){var d=o.tileWidth?o.tileWidth:g+h<<0,l=o.tileHeight?o.tileHeight:g+a<<0;e&&(s-=e.left,r-=e.top),t.drawImage(this._bitmap,o.col*d,o.type.row*l,d,l,g+s<<0,g+r<<0,g+h<<0,g+a<<0)}else if(e){var p=function(t,e){var i=t.left,n=t.top,o=t.width,s=t.height,r=e.left,h=e.top,a=e.width,d=e.height;return{src:{left:i>r?0:r-i,top:n>h?0:h-n,width:o=i>r?Math.min(o,a-(i-r)):Math.min(a,o-(r-i)),height:s=n>h?Math.min(s,d-(n-h)):Math.min(d,s-(h-n))},dest:{left:i>r?i-r:0,top:n>h?n-h:0,width:o,height:s}}}(i,e),u=p.src,c=p.dest;t.drawImage(this._bitmap,g+u.left<<0,g+u.top<<0,g+u.width<<0,g+u.height<<0,g+c.left<<0,g+c.top<<0,g+c.width<<0,g+c.height<<0)}else t.drawImage(this._bitmap,g+s<<0,g+r<<0,g+h<<0,g+a<<0)}for(var _=this._children[0];_;)_.draw(t,e),_=_.next;this._mask&&(t.globalCompositeOperation="source-over"),t.restore(),this.canvas.DEBUG&&this.drawOutline(t)}},v.prototype.insideBounds=function(t,e){var i=this._bounds,n=i.left,o=i.top,s=i.width,r=i.height;return t>=n&&t<=n+s&&e>=o&&e<=o+r},v.prototype.collidesWith=function(t){if(t===this)return!1;var e=this._bounds,i=t.getBounds();return!(e.top+e.height<i.top||e.top>i.top+i.height||e.left+e.width<i.left||e.left>i.left+i.width)},v.prototype.getIntersection=function(t){if(this.collidesWith(t)){var e=this._bounds,i=t.getBounds(),n=f(e.left,i.left),o=f(e.top,i.top);return{left:n,top:o,width:_(e.left+e.width,i.width+i.height)-n,height:_(e.top+e.height,i.top+i.height)-o}}return null},v.prototype.collidesWithEdge=function(t,e){if(t===this)return!1;if(isNaN(e)||e<0||e>3)throw new Error("invalid argument for edge");switch(e){case 0:return this.getX()<=t.getX()+t.getWidth();case 1:return this.getY()<=t.getY()+t.getHeight();case 2:return this.getX()+this.getWidth()<=t.getX();case 3:return this.getY()+this.getHeight()>=t.getY()}return!1},v.prototype.getBitmap=function(){return this._bitmap},v.prototype.setBitmap=function(t,e,i){var n=this,o=t instanceof window.HTMLCanvasElement,s=t instanceof window.HTMLImageElement;if(t&&!o&&!s&&"string"!=typeof t)throw new Error('expected HTMLImageElement, HTMLCanvasElement or String for Image source, got "'.concat(t,'" instead'));return new Promise((function(r,h){if(n._bitmap!==t&&(n._bitmapReady=!1),t){var a="number"==typeof e,d="number"==typeof i;if(a&&n.setWidth(e),d&&n.setHeight(i),n._keepInBounds&&n.canvas&&(a||d)){var l=-(n._bounds.width-n.canvas.getWidth()),p=-(n._bounds.height-n.canvas.getHeight());n._bounds.left>0?n._bounds.left=0:n._bounds.left<l&&(n._bounds.left=l),n._bounds.top>0?n._bounds.top=0:n._bounds.top<p&&(n._bounds.top=p)}if(o)return n._bitmap=t,n._bitmapReady=!0,r();u.loadImage(s?t.src:t,s?t:null).then((function(t){var e=t.size,i=t.image;n._bitmap=i,n._bitmapReady=!0,n._bitmapWidth=e.width,n._bitmapHeight=e.height,n.invalidate(),r()})).catch((function(t){h(new Error('zSprite.setBitmap() "'.concat(null==t?void 0:t.message,'" occurred.')))}))}else n._bitmap=null}))},v.prototype.setSheet=function(t,e,i){this._sheet=t,t?(this._animation={type:null,col:0,maxCol:0,fpt:0,counter:0},"number"==typeof e&&(this._animation.tileWidth=e),"number"==typeof i&&(this._animation.tileHeight=i),this.switchAnimation(0)):this._animation=null},v.prototype.switchAnimation=function(t){var e=this._animation,i=this._sheet[t];e.type=i,e.fpt=i.fpt,e.maxCol=i.col+(i.amount-1),e.col=i.col,e.counter=0,e.onComplete=i.onComplete},v.prototype.setParent=function(t){this._parent=t},v.prototype.getParent=function(){return this._parent},v.prototype.setCanvas=function(t){this.canvas=t,this._children.forEach((function(e){e.setCanvas(t)}))},v.prototype.setConstraint=function(t,e,i,n){return this._constraint={left:t,top:e,width:i,height:n},this._bounds.left=f(t,this._bounds.left),this._bounds.top=f(e,this._bounds.top),this._keepInBounds=!0,this.getConstraint()},v.prototype.getConstraint=function(){return this._constraint},v.prototype.addChild=function(t){if(this.contains(t))return this;var e=this._children.length;return e>0&&(t.last=this._children[e-1],t.last.next=t,t.next=null),t.setCanvas(this.canvas),t.setParent(this),this._children.push(t),this.invalidate(),this},v.prototype.removeChild=function(t){t.setParent(null),t.setCanvas(null);var e=this._children.indexOf(t);-1!==e&&this._children.splice(e,1);var i=t.last,n=t.next;return i&&(i.next=n),n&&(n.last=i),t.last=t.next=null,this.invalidate(),t},v.prototype.getChildAt=function(t){return this._children[t]},v.prototype.removeChildAt=function(t){return this.removeChild(this.getChildAt(t))},v.prototype.numChildren=function(){return this._children.length},v.prototype.getChildren=function(){return this._children},v.prototype.contains=function(t){return t._parent===this},v.prototype.dispose=function(){if(!this._disposed){this._disposed=!0,this._parent&&this._parent.removeChild(this);for(var t=this._children.length;t--;){var e=this._children[t];e.dispose(),e.next=null,e.last=null}this._children=[]}},v.prototype.handlePress=function(t,e,i){},v.prototype.handleRelease=function(t,e,i){},v.prototype.handleClick=function(){},v.prototype.handleMove=function(t,e,i){var n=this._dragStartOffset.x+(t-this._dragStartEventCoordinates.x),o=this._dragStartOffset.y+(e-this._dragStartEventCoordinates.y);this.setBounds(n,o,this._bounds.width,this._bounds.height)},v.prototype.handleInteraction=function(t,e,i){var n,o=this._children.length;if(o>0)for(n=this._children[o-1];n;){if(n.handleInteraction(t,e,i))return!0;n=n.last}if(!this._interactive)return!1;var s=i.type;if(this._pressed&&("touchend"===s||"mouseup"===s))return this._pressed=!1,this.isDragging&&(this.isDragging=!1),Date.now()-this._pressTime<250&&this.handleClick(),this.handleRelease(t,e,i),!0;if(this.insideBounds(t,e)){if(this.hover=!0,"touchstart"===s||"mousedown"===s)return this._pressTime=Date.now(),this._pressed=!0,this._draggable&&(this.isDragging=!0,this._dragStartOffset={x:this._bounds.left,y:this._bounds.top},this._dragStartEventCoordinates={x:t,y:e}),this.handlePress(t,e,i),"touchstart"===s&&(i.stopPropagation(),i.preventDefault()),!0}else this.hover=!1;return!!this.isDragging&&(this.handleMove(t,e,i),!0)},v.prototype.invalidate=function(){this.canvas&&this.canvas.invalidate()},v.prototype.updateAnimation=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this._animation;e.counter+=t,e.counter>=e.fpt&&(++e.col,e.counter=e.counter%e.fpt),e.col>e.maxCol&&(e.col=e.type.col,"function"==typeof e.onComplete&&e.onComplete(this))},v.prototype.drawOutline=function(t){t.lineWidth=1,t.strokeStyle="#FF0000",t.strokeRect(this.getX(),this.getY(),this.getWidth(),this.getHeight())},new Map})();